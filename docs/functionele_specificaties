# Functionele Specificaties Bevragingen ingeschreven natuurlijk personen

## Doel van dit document
Dit document beschrijft de API voor het bevragen van ingeschreven natuurlijk personen voor niet-technische gebruikers van de API.
Tot de doelgroep behoren bijvoorbeeld informatie managers, architecten, inkopers en product managers.

## Doel van de API
Het doel van de API is om op een eenvoudige en eenduidige manier persoonsgegevens te ontsluiten. Dit betreft het raadplegen van personen en het zoeken van personen die zijn ingeschreven in het GBA of in het andernatuurlijkpersonen.

## Visie
Uitgangspunt voor de API is bevragen bij de bron, waarbij de bron voor ingeschreven natuurlijk personen de GBA (BRP) is.
Gestreefd wordt naar een landelijke voorziening waar deze API op beschikbaar komt.
Tot dat moment kan de API worden gerealiseerd in de gemeentelijke GBA of een gegevensmagazijn.

Gegevens van natuurlijk personen die niet in het GBA (BRP) zitten, zoals gemeentelijke kerngegevens (bijvoorbeeld correspondentieadres, e-mailadres) zijn niet opgenomen in de API.

De gegevens in de API zijn zoveel mogelijk gemodelleerd zoals deze ook in de bron zitten, dus conform LO GBA.

De API is zodanig ontworpen dat deze zo eenvoudig mogelijk geïmplementeerd kan worden, het principe van 'developer first'. Developers van de API worden geschouwd als de primaire "gebruikers" van de API.
De API is geoptimaliseerd voor eenvoud van gebruik voor consumers van de API. Er zijn immers veel meer gebruikers (consumers) van de API dan providers van de API.

Bij het ontwerp van de API is gestreefd deze zoveel mogelijk RESTful te laten zijn.

De API wordt agile (door)ontwikkeld. Voor de eerste versie is de informatiebehoefte die is geïnventariseerd voor koppelvlakstandaard RSGB-bevragingen gebruikt. De standaard kan op basis van user stories, daadwerkelijke functionele vraag in processen en ketens, worden uitgebreid.

## Functionaliteit
De API ondersteunt de volgende functionaliteit:

### Ik wil ingeschreven natuurlijk personen zoeken op de geslachtsnaam
Het is mogelijk ingeschreven natuurlijk personen te zoeken op de volgende eigenschappen van de persoon:
* geslachtsnaam
* geboortedatum
* voornamen
* voorvoegselGeslachtsnaam
* geslachtsaanduiding
* geboorteplaats

Bij het zoeken op geslachtsnaam mag een wildcard worden gebruikt. Bijvoorbeeld door te zoeken op "jans*" kun je "Jansen", "Jansens", enz. vinden.
Bij het zoeken op voornamen mag een wildcard worden gebruikt.
Bij het zoeken/ op geboortedatum mag *geen* onvolledige datum worden gebruikt.
Het is mogelijk te kiezen om ook of juist geen overleden personen terug te krijgen.
Het is mogelijk te kiezen om ook of juist geen niet-ingezeten terug te krijgen.

Als resultaat van de zoekvraag wordt een lijst gegeven van de gevonden ingeschreven natuurlijk personen.

Het is mogelijk in de zoekvraag aan te geven welke attributen moeten worden teruggegeven. Standaard worden alle attributen van de persoon in het antwoord teruggegeven.
Standaard worden in het antwoord relaties naar andere objecttypen (zoals kinderen, ouders, partner, adres) teruggegeven als hyperlink. De gegevens van de relatie (gerelateerde) kunnen dan in een extra aanroep worden opgevraagd. Het is ook mogelijk in de zoekvraag aan te geven welke relaties direct moeten worden gegeven met de persoon. Op deze manier is het bijvoorbeeld mogelijk in één vraag de gevonden persoon en diens partner te krijgen.

Deze functionaliteit is te gebruiken via de resource /ingeschrevennatuurlijkpersonen

### Ik wil ingeschreven natuurlijk personen zoeken op het verblijfplaats
Het is mogelijk ingeschreven personen te zoeken die op een adres verblijven. Het gaat hier om ingeschreven natuurlijk personen die het opgegeven adres als actuele verblijfplaats hebben.

Dit kan door te zoeken op de volgende eigenschappen van de verblijfsplaats:
* postcode
* huisnummer
* huisletter
* huisnummertoevoeging
* identificatiecodenummeraanduiding

Het is mogelijk te kiezen om ook of juist geen overleden personen terug te krijgen

Als resultaat van de zoekvraag wordt een lijst gegeven van de gevonden adressen met voor elk adres de ingeschreven natuurlijk personen die dit adres als actuele verblijfplaats hebben.

Het is mogelijk in de zoekvraag aan te geven welke attributen moeten worden teruggegeven. Standaard worden alle attributen van de persoon in het antwoord teruggegeven.

Standaard worden in het antwoord de bewoners (ingeschreven natuurlijk personen) teruggegeven als hyperlink. De gegevens van de persoon kunnen dan in een extra aanroep worden opgevraagd. Het is ook mogelijk in de zoekvraag aan te geven dat de attributen van de gevonden bewoners direct moeten worden teruggegeven.

Deze functionaliteit is te gebruiken via de resource /bewoningen

### Ik wil een ingeschreven natuurlijk persoon raadplegen
Het is mogelijk de gegevens van een ingeschreven natuurlijk persoon te raadplegen. De ingeschreven natuurlijk persoon wordt geïdentificeerd (uri) door het burgerservicenummer van de persoon.

Als resultaat worden de attributen van de ingeschreven natuurlijk persoon teruggegeven.

Het is mogelijk in de vraag aan te geven welke attributen moeten worden teruggegeven. Standaard worden alle attributen van de persoon in het antwoord teruggegeven.

Standaard worden in het antwoord relaties naar andere objecttypen (zoals kinderen, ouders, partner, adres) teruggegeven als hyperlink. De gegevens van de relatie (gerelateerde) kunnen dan in een extra aanroep worden opgevraagd. Het is ook mogelijk in de zoekvraag aan te geven welke relaties direct moeten worden gegeven met de persoon. Op deze manier is het bijvoorbeeld mogelijk in één vraag de gevonden persoon en diens partner te krijgen.

Deze functionaliteit is te gebruiken via de resource /bewoningen/{burgerservicenummer}

### Ik wil de verblijfsplaatshistorie van een ingeschreven natuurlijk persoon raadplegen
Het is mogelijk te raadplegen welke verblijfsplaatsen een ingeschreven natuurlijk persoon heeft gehad. De ingeschreven natuurlijk persoon wordt geïdentificeerd (uri) door het burgerservicenummer van de persoon. De historie die wordt teruggegeven betreft de materiële historie.

Bij de vraag kan de periode (van en tot en met) worden opgegeven waarvoor de verblijfsplaatshistorie gewenst wordt. Ook kan een peildatum worden opgegeven, waarmee de verblijfsplaats wordt teruggegeven die geldig was op de opgegeven peildatum.

Als resultaat worden de attributen van de ingeschreven natuurlijk persoon teruggegeven, waarbij de historische voorkomens van de verblijfsplaats allemaal worden opgenomen. In elk historisch voorkomen van de verblijfsplaats bevat de begin- en einddatum van geldigheid van de verblijfsplaats.

Deze functionaliteit is te gebruiken via de resource /verblijfsplaatshistoriepersoon/{burgerservicenummer}

### Ik wil de partnerhistorie van een ingeschreven natuurlijk persoon raadplegen
Het is mogelijk de historie van partners van een ingeschreven natuurlijk persoon te raadplegen. De historie die wordt teruggegeven betreft de materiële historie.

Bij de vraag kan de periode (van en tot en met) worden opgegeven waarvoor de partnerplaatshistorie gewenst wordt. Ook kan een peildatum worden opgegeven, waarmee de partner wordt teruggegeven die geldig was op de opgegeven peildatum.

Als resultaat wordt het burgerservicenummer van de ingeschreven natuurlijk persoon teruggegeven en een lijst met voor elk historisch partnerschap de link waarmee de details over het partnerschap kunnen worden opgehaald.
Het is mogelijk in de zoekvraag aan te geven dat de attributen van elk historisch voorkomen van partnerschap van de persoon in het antwoord moeten worden teruggegeven.

Deze functionaliteit is te gebruiken via de resource /partnerhistoriepersoon/{burgerservicenummer}

### Ik wil de verblijfstitelhistorie van een ingeschreven natuurlijk persoon raadplegen
Het is mogelijk de historie van de verblijfstitel van een ingeschreven natuurlijk persoon te raadplegen.

Bij de vraag kan de periode (van en tot en met) worden opgegeven waarvoor de verblijfstitelhistorie gewenst wordt. Ook kan een peildatum worden opgegeven, waarmee de verblijfstitel wordt teruggegeven die geldig was op de opgegeven peildatum.

Als resultaat wordt het burgerservicenummer van de ingeschreven natuurlijk persoon teruggegeven en een lijst met voor elk historisch voorkomen van verblijfstitel de Ingangsdatum verblijfstitel, Datum einde verblijfstitel en de aanduidingVerblijfstitel.

Deze functionaliteit is te gebruiken via de resource /verblijfstitelhistoriepersoon/{burgerservicenummer}

### Ik wil de bewoning van een verblijfsadres raadplegen, zodat ik kan zien welke personen gedurende welke periode op een verblijfsadres zijn/waren ingeschreven.
Het is mogelijk te raadplegen welke bewoners er op een adres verblijven of hebben verbleven. Hiermee worden alle ingeschreven natuurlijk personen gezocht die het opgegeven adres als verblijfsplaats hebben (gehad).

Dit kan door te zoeken op de volgende eigenschappen van de verblijfsplaats:
* postcode
* huisnummer
* huisletter
* huisnummertoevoeging
* identificatiecodenummeraanduiding

Bij de vraag kan de periode (van en tot en met) worden opgegeven waarvoor de bewoning gewenst wordt. Ook kan een peildatum worden opgegeven, waarmee de bewoners worden teruggegeven die geldig was op de opgegeven peildatum.

Als resultaat wordt een lijst met verblijfsplaatsen (adressen) gegeven, met per verblijfsplaats een lijst met bewoners (ingeschreven natuurlijk personen). Bij elke bewoner is de begin- en einddatum opgenomen van de bewoning.

Deze functionaliteit is te gebruiken via de resource /bewoninghistorie

## Algemene werking van de API
### Pagineren
Zoekvragen kunnen mogelijk veel resultaten teruggeven. De provider van de API kan het aantal zoekresultaten per zoekvraag beperken. In dat geval wordt een maximaal aantal resultaten teruggegeven op een zoekvraag. Meer resultaten kunnen worden teruggegeven met een volgende zoekvraag. Bij een zoekvraag kan daartoe worden aangegeven naar welke "pagina" aan zoekresultaten gevraagd wordt.

Om dit te ondersteunen wordt bij het antwoord een aantal links meegegeven om te navigeren door het resultaat:
* Eerste pagina
* Vorige pagina
* Volgende pagina
* Laatste pagina

### Bepalen van de inhoud van het antwoord
Het is mogelijk in de vraag aan te geven welke attributen moeten worden teruggegeven. Standaard worden alle attributen van de persoon in het antwoord teruggegeven. De gebruiker kan de gewenste attributen in het antwoord opgeven via vraagparameter "fields", waarin de veldnamen kommagescheiden worden opgenomen.

Standaard worden in het antwoord relaties naar andere objecttypen (zoals kinderen, ouders, partner, adres) teruggegeven als link met de uri (unieke resource identificatie) naar de betreffende resource. De attributen van de relatie (gerelateerde) kunnen dan in een extra aanroep worden opgevraagd. Het is ook mogelijk in de zoekvraag aan te geven welke relaties direct moeten worden gegeven in het antwoord.  De gebruiker kan de gewenste op te nemen gerelateerde resources opgeven in zoekparameter "expand", waarin de relatienamen kommagescheiden worden opgenomen.

### Opvragen van gerelateerde resources
Wanneer een ingeschreven natuurlijk persoon relaties heeft, naar bijvoorbeeld een kind, ouder, partner, nummeraanduiding (adres), reisdocument, wordt deze in het antwoord opgenomen als link (uri) naar de betreffende gerelateerde resource. Deze gerelateerde resource kan hiermee worden opgevraagd.

Voor elk soort gegeven (objecttype) waarnaar vanuit de ingeschreven natuurlijk persoon relaties kunnen bestaan, is een resource gedefinieerd in de API. De volgende resources kunnen worden geraadpleegd:
* /reisdocumenten/{reisdocumentnummer}
* /andernatuurlijkpersonen/{uuid}
* /ingeschrevennatuurlijkpersonen/{burgerservicenummer}/partners/{uuid}
* /ingeschrevennatuurlijkpersonen/{burgerservicenummer}/kinderen/{uuid}

De resource van een nummeraanduiding valt binnen de BAG en maakt geen deel uit van de API voor het bevragen van natuurlijk personen.

### Autorisatie
De API levert alleen gegevens terug waar de vragende organisatie voor geautoriseerd is. De vragende applicatie is verantwoordelijk voor het filteren van het antwoord op autorisatie van de gebruiker.

## Migratie en doorontwikkeling van de standaard
De API is ontwikkeld met het oog op de ambitie van een landelijke voorziening voor het bevragen van de GBA gegevens, waarop kan worden aangesloten met de NLX voorziening die door de Common Ground beweging wordt gerealiseerd. Deze voorziening maakt het mogelijk om veilig te communiceren tussen partijen op een manier die AVG-compliant is. Implementatie van deze architectuur is mogelijk op het moment dat de landelijke voorziening beschikbaar is én NLX een productiestatus heeft gekregen.

Tot dat moment kan de API worden gerealiseerd door de locale BRP (GBA + RNI), of door een gegevensmagazijn.

### Samengestelde diensten
De API levert alleen gegevens uit de betreffende bron: BRP (GBA plus RNI). Dit betekent dat verschillende voor ingeschreven natuurlijk personen relevante gegevens niet door deze API worden geleverd. Dit betreft gemeentelijke kerngegevens (bijvoorbeeld correspondentieadres) en attributen van gerelateerde resources uit een andere bron (bijvoorbeeld de nummeraanduiding uit de BAG).

Om deze gegevens ter beschikking te krijgen zou er:
* Een API ontwikkeld moeten worden voor het ontsluiten van de gemeentelijke kerngegevens
* Een API ontwikkeld moeten worden voor het bevragen van de gerelateerde registratie (BAG)
* Een API ontwikkeld moeten worden voor de samengestelde vragen (BRP + kerngegevens + BAG-gegevens)
