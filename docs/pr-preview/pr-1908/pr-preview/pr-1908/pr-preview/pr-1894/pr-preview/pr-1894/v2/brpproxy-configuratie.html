<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-16">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/assets/style.css">
    

    <title></title>
  </head>
  <body>
    <div class="container-fluid">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/">
          <img src="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/assets/img/haal_centraal_zon_geel_RGB.png" width="238px">
        </a>
        <span class="navbar-text">BRP API Personen</span>
        
          <a class="navbar-brand-right" href="http://www.rvig.nl/" target="_blank">
            <img src="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/assets/img/BZK_RIG_Logo_online_ex_pos_nl.png" width="238px">
          </a>
        
      </nav>
      <div style="height: 0px; border-top: 1px solid #b1b1b1;box-shadow: 0 -5px 5px -5px #7c7c7c;"></div>
      <nav class="navbar navbar-expand-lg navbar-light bg-light" style="text-align: right;">
        <div class="collapse navbar-collapse">
    <ul class="navbar-nav mx-auto">
      <li class="nav-item active">
        <a class="nav-link" href="https://vng-realisatie.github.io/Haal-Centraal/">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Starten met Haal Centraal
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/starten-met-haal-centraal">Startgids</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/transitieplan">Transitieplan</a>
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/security">Security</a>
       </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Aansluiten op API's
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/aansluiten-op-apis">Aansluiten op API's</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="https://lvbag.github.io/BAG-Gemeentelijke-wensen-tav-BAG-Bevragingen/">BAG Individuele Bevragingen (live)</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="https://kadaster.github.io/BRK-bevragen/">BRK Bevragen (live)</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="https://brp-api.github.io/Haal-Centraal-BRP-bevragen/">BRP Persoon (live)</a>
          <a class="dropdown-item" href="https://brp-api.github.io/Haal-Centraal-BRP-historie-bevragen/">BRP Historie (live)</a>
          <a class="dropdown-item" href="https://brp-api.github.io/Haal-Centraal-BRP-bewoning/">BRP Bewoning (live)</a>
          <a class="dropdown-item" href="https://brp-api.github.io/Haal-Centraal-Reisdocumenten-bevragen//">BRP Reisdocumenten (live)</a>
          <a class="dropdown-item" href="https://brp-api.github.io/Haal-Centraal-BRP-tabellen-bevragen/">BRP Tabellen</a>
          <a class="dropdown-item" href="https://brp-api.github.io/Haal-Centraal-BRP-Update-API/">BRP Update API</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="https://kadaster.github.io/WOZ-bevragen/">WOZ Bevragen (live)</a>
       </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Bijdragen aan API's</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/hoe-kun-je-bijdragen">Bijdragen aan API's</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/bug_melden">Bug melden</a>
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/verbetervoorstel">Verbetervoorstel</a>
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/gebruikerswens">Gebruikerswens</a>
       </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link" href="https://vng-realisatie.github.io/Haal-Centraal/over-haal-centraal">Over Haal Centraal</a>
<!--        <a class="nav-link dropdown" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Over Haal Centraal</a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="https://vng-realisatie.github.io/Haal-Centraal/planning">Planning</a>
       </div-->
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://vng-realisatie.github.io/Haal-Centraal/contact">Contact</a>
      </li>
    </ul>
</div>

      </nav>
    </div>
    <div class="container-fluid">
    <div class="row">
        <div class="col-2">
	<div class="header">BRP Personen Bevragen</div>
	<nav class="nav flex-column">
    
      
	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/" target="">Main</a>

	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/goals-canvas" target="">Goals canvas</a>

    
  
	<div class="header">Specificaties v. 2</div>
	<nav class="nav flex-column">
    
      
	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/releasenotes" target="">Releasenotes</a>

	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/v2/getting-started" target="">Getting started</a>

	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/user-stories-prod" target="">User stories</a>

	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/v2/redoc" target="">Bevragen API</a>

	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/v2/features-overzicht" target="">Features overzicht</a>

	
	<a class="nav-link" href="/Haal-Centraal-BRP-bevragen/pr-preview/pr-1894/features/index" target="">Features test overzicht</a>

    
  
</nav>
</div>
        <div class="col-9"><h1 id="brpproxy-configuratie">BrpProxy configuratie</h1>

<p>De volgende settings van de BrpProxy kunnen worden aangepast:</p>

<ul>
  <li><a href="#routering">Routering</a></li>
  <li><a href="#logging">Logging</a></li>
  <li><a href="#tracing">Tracing</a></li>
</ul>

<h2 id="routering">Routering</h2>

<p>Standaard is de BrpProxy geconfigureerd om bevragingen door te sturen naar de mock van de BRP API Personen Web API GBA variant.</p>

<p>De <strong>Downstream</strong> configuratie van de BrpProxy moet worden aangepast om bevragingen door te sturen naar een andere instantie van de BRP API Personen Web API GBA variant.</p>

<h3 id="wijzigen-van-de-downstream-configuratie-van-de-brpproxy-docker-compose-variant">Wijzigen van de Downstream configuratie van de BrpProxy (Docker Compose variant)</h3>

<p>De volgende environment variabelen moet worden opgenomen in de configuratie van de BrpProxy in het <a href="https://github.com/BRP-API/Haal-Centraal-BRP-bevragen/blob/master/docker-compose.yml" target="_blank" rel="noopener">docker compose bestand</a>:</p>

<ul>
  <li>Routes__0__DownstreamScheme. De communicatie protocol die moet worden gebruikt voor het aanroepen van de BRP API Personen Web API GBA variant</li>
  <li>Routes__0__DownstreamHostAndPorts__0__Host. De host naam van de aan te roepen BRP API Personen Web API GBA variant</li>
  <li>Routes__0__DownstreamHostAndPorts__0__Port. De port nummer van de aan te roepen  BRP API Personen Web API GBA variant</li>
</ul>

<p>In het volgende voorbeeld is de BrpProxy geconfigureerd om bevragingen door te sturen naar de proef omgeving van de BRP API Personen Web API GBA variant</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="na">brpproxy</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">brpproxy</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ghcr.io/brp-api/haal-centraal-brp-bevragen-proxy:latest</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">ASPNETCORE_ENVIRONMENT=Release</span>
      <span class="pi">-</span> <span class="s">ASPNETCORE_URLS=http://+:5000</span>
      <span class="pi">-</span> <span class="s">Routes__0__DownstreamScheme=https</span>
      <span class="pi">-</span> <span class="s">Routes__0__DownstreamHostAndPorts__0__Host=proefomgeving-gba.haalcentraal.nl</span>
      <span class="pi">-</span> <span class="s">Routes__0__DownstreamHostAndPorts__0__Port=443</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5001:5000"</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">brp-api-network</span>

</code></pre></div></div>

<p>Een andere mogelijkheid is om de routering configuratie te definieren in een json bestand en met behulp van een Volume te monteren aan een container instantie.</p>

<p>In het volgende voorbeeld is de configuratie van de routering naar de proef omgeving van de BRP API Personen Web API GBA variant gespecificeerd. Dit <a href="https://github.com/BRP-API/Haal-Centraal-BRP-bevragen/blob/develop/src/config/BrpProxy/configuration/ocelot.json" target="_blank" rel="noopener">configuratie bestand</a> is ook te vinden in de BRP API Personen GitHub repository.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"Routes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"UpstreamPathTemplate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/haalcentraal/api/brp/personen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DownstreamPathTemplate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/haalcentraal/api/brp/personen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DownstreamScheme"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DownstreamHostAndPorts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"proefomgeving-gba.haalcentraal.nl"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"443"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<p>Het configuratie bestand wordt vervolgens met behulp van een volume gemonteerd aan een BrpProxy instantie. In onderstaand voorbeeld wordt het ocelot.json bestand in de src/config/BrpProxy/configuration map gemonteerd aan een BrpProxy instantie.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="na">brpproxy</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">brpproxy</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">iswish/haal-centraal-brp-bevragen-proxy:latest</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">ASPNETCORE_ENVIRONMENT=Release</span>
      <span class="pi">-</span> <span class="s">ASPNETCORE_URLS=http://+:5000</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5001:5000"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./src/config/BrpProxy/configuration/ocelot.json:/app/configuration/ocelot.json</span>

</code></pre></div></div>

<h3 id="wijzigen-van-de-downstream-configuratie-van-de-brpproxy-kubernetes-variant">Wijzigen van de Downstream configuratie van de BrpProxy (Kubernetes variant)</h3>

<p>De volgende environment variabelen moet worden opgenomen in de configuratie van de BrpProxy in het <a href="https://github.com/BRP-API/Haal-Centraal-BRP-bevragen/blob/develop/.k8s/brpproxy-deployment.yml" target="_blank" rel="noopener">brpproxy deployment bestand</a>:</p>

<ul>
  <li>Routes__0__DownstreamScheme. De communicatie protocol die moet worden gebruikt voor het aanroepen van de BRP API Personen Web API GBA variant</li>
  <li>Routes__0__DownstreamHostAndPorts__0__Host. De host naam van de aan te roepen BRP API Personen Web API GBA variant</li>
  <li>Routes__0__DownstreamHostAndPorts__0__Port. De port nummer van de aan te roepen BRP API Personen Web API GBA variant</li>
</ul>

<p>In het volgende voorbeeld is de BrpProxy geconfigureerd om bevragingen door te sturen naar de proef omgeving van de BRP API Personen Web API GBA variant</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">brpproxy</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">iswish/haal-centraal-brp-bevragen-proxy:latest</span>
          <span class="na">env</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ASPNETCORE_ENVIRONMENT</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">Release</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ASPNETCORE_URLS</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">http://+:5000</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Routes__0__DownstreamScheme</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">https</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Routes__0__DownstreamHostAndPorts__0__Host</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">proefomgeving-gba.haalcentraal.nl</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Routes__0__DownstreamHostAndPorts__0__Port</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">443"</span>
          <span class="na">ports</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">http-brpproxy</span>
              <span class="na">containerPort</span><span class="pi">:</span> <span class="m">5000</span>

</code></pre></div></div>

<p>Een andere mogelijkheid is om de routering configuratie te definieren in een json bestand en met behulp van een volume mount te monteren aan een container instantie.</p>

<p>In het volgende voorbeeld is de configuratie van de routering naar de proef omgeving van de BRP API Personen Web API GBA variant gespecificeerd. Dit <a href="https://github.com/BRP-API/Haal-Centraal-BRP-bevragen/blob/develop/src/config/BrpProxy/configuration/ocelot.json" target="_blank" rel="noopener">configuratie bestand</a> is ook te vinden in de BRP API Personen GitHub repository.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"Routes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"UpstreamPathTemplate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/haalcentraal/api/brp/personen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DownstreamPathTemplate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/haalcentraal/api/brp/personen"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DownstreamScheme"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DownstreamHostAndPorts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"Host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"proefomgeving-gba.haalcentraal.nl"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"443"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<p>Het configuratie bestand wordt vervolgens met behulp van een volume mount gemonteerd aan een BrpProxy instantie. In onderstaand voorbeeld wordt het ocelot.json bestand in de src/config/BrpProxy/configuration map gemonteerd aan een BrpProxy instantie.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">brpproxy</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">iswish/haal-centraal-brp-bevragen-proxy:latest</span>
          <span class="na">env</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ASPNETCORE_ENVIRONMENT</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">Release</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ASPNETCORE_URLS</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">http://+:5000</span>
          <span class="na">ports</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">http-brpproxy</span>
              <span class="na">containerPort</span><span class="pi">:</span> <span class="m">5000</span>
          <span class="na">volumeMounts</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">brpproxy-routing-configuration</span>
              <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/app/configuration</span>
      <span class="na">volumes</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">brpproxy-routing-configuration</span>
          <span class="na">hostPath</span><span class="pi">:</span>
            <span class="na">path</span><span class="pi">:</span> <span class="s">&lt;host-path&gt;/Haal-Centraal-BRP-bevragen/src/config/BrpProxy/configuration</span>

</code></pre></div></div>

<p>waarbij <strong>host-path</strong> gelijk is aan</p>

<ul>
  <li><em>/run/desktop/mnt/host/c/Haal-Centraal-BRP-bevragen/src/config/BrpProxy/configuration</em> voor een Windows machine waarop Docker Desktop is geïnstalleerd en Kubernetes ondersteuning is aangezet en de  repository is gecloned naar de c:/Haal-Centraal-BRP-bevragen map.</li>
</ul>

<h2 id="logging">Logging</h2>

<p>Standaard is de BrpProxy geconfigureerd met Log level <code class="language-plaintext highlighter-rouge">Warning</code>. Bij deze Log level wordt alleen ongeldige bevragingen (bevraging die resulteren in een 4XX en 5XX HTTP status response) gelogd.</p>

<p>Om alle bevragingen (inclusief de request body) te loggen moet de Log level op <code class="language-plaintext highlighter-rouge">Information</code> worden gezet. Dit wordt gedaan met behulp van de <em>Serilog__MinimumLevel__Override__BrpProxy</em> environment variabele.</p>

<p>In de volgend voorbeelden is de Log level gezet op <code class="language-plaintext highlighter-rouge">Information</code></p>

<p>Docker Compose variant:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="na">brpproxy</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">brpproxy</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">iswish/haal-centraal-brp-bevragen-proxy:latest</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">ASPNETCORE_ENVIRONMENT=Release</span>
      <span class="pi">-</span> <span class="s">ASPNETCORE_URLS=http://+:5000</span>
      <span class="pi">-</span> <span class="s">Serilog__MinimumLevel__Override__BrpProxy=Information</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5001:5000"</span>

</code></pre></div></div>

<p>Kubernetes variant</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">brpproxy</span>
          <span class="na">image</span><span class="pi">:</span> <span class="s">iswish/haal-centraal-brp-bevragen-proxy:latest</span>
          <span class="na">env</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ASPNETCORE_ENVIRONMENT</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">Release</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">ASPNETCORE_URLS</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">http://+:5000</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Serilog__MinimumLevel__Override__BrpProxy</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">Information</span>
          <span class="na">ports</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">http-brpproxy</span>
              <span class="na">containerPort</span><span class="pi">:</span> <span class="m">5000</span>

</code></pre></div></div>

<p>Bij Log level <code class="language-plaintext highlighter-rouge">Information</code> worden de waarden van gevoelige parameters in de request body gemaskeerd gelogd. Voor debug doeleinden kan het nodig zijn om de waarden van gevoelige parameters niet gemaskeerd te loggen. Dit kan worden gedaan door de Log level op <code class="language-plaintext highlighter-rouge">Debug</code> te zetten.</p>

<p>De logs zijn standaard te vinden in de Logs tab blad van de BrpProxy container. Optioneel kunnen de logs ook worden weggeschreven naar een Seq server en/of naar een log bestand volgens de Elastic Common Schema specificatie.</p>

<p>De <em>Seq__ServerUrl</em> environment variabele moeten worden gebruikt om log regels weg te schrijven naar een Seq server. Met het <a href="https://github.com/BRP-API/Haal-Centraal-BRP-bevragen/blob/develop/docker-compose.yml" target="_blank" rel="noopener">docker compose bestand</a> in de BRP API Personen repository wordt standaard ook een Seq server opgestart waar de BrpProxy zijn log regels wegschrijft.</p>

<p>Met behulp van de <em>Ecs__Path</em> environment variabele wordt het volledig pad van het log bestand opgegeven waar log regels volgens de Elastic Common Schema specificatie worden weggeschreven.</p>

<h2 id="tracing">Tracing</h2>

<p>De BrpProxy maakt gebruik van OpenTelemetry om de start en eind tijden van aanroepen weg te schrijven. De BrpProxy gebruikt de standaard configuratie settings van Jaeger om traces te schrijven naar een Jaeger server met behulp van de OpenTelemetry Protocol (OTLP).</p>

<p>Een Jaeger server wordt standaard opgestart wanneer het <a href="https://github.com/BRP-API/Haal-Centraal-BRP-bevragen/blob/develop/docker-compose.yml" target="_blank" rel="noopener">docker compose bestand</a> in de BRP API Personen repository wordt gebruikt om de BrpProxy te draaien. De traces kunnen dan worden bekeken via de Jaeger UI die is te benaderen op <code class="language-plaintext highlighter-rouge">http://localhost:16686</code>.</p>

<p>De <em>Jaeger__OtlpEndpoint</em> environment variabele kan worden gebruikt om de OTLP endpoint waar de BrpProxy naar schrijft te wijzigen.</p>
</div>
    </div>
</div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    
  </body>
</html>
